seed: 1
exp_name: opt-125m_opt-6.7b_reinforce_equal_l2_reg_scale10_target0.3_5e-4
datasets:
- gsm8k
debug: false
wandb:
  enabled: true
  entity: null
  project: Ensemble
cache_dir: /home/sagemaker-user/data/model
local_run_dir: ${cache_dir}/${exp_name}
do_first_eval: true
minimum_log_interval_secs: 1.0
intermediate_checkpoints: false
trainer: BasicTrainer
lr: 0.0005
n_epochs: 1
global_epochs: 1
n_examples: 100
n_eval_examples: 256
eval_every: 1000
optimizer: AdamW
warmup_steps: 150
cache_reference_logprobs: false
load_reference_logprobs: null
frac_unique_desirable: 1.0
frac_unique_undesirable: 1.0
model:
  name_or_path: null
  tokenizer_name_or_path: null
  load_from: null
  from_checkpoint: null
  block_name: OPTDecoderLayer
  policy_dtype: bfloat16
  reference_dtype: bfloat16
  max_grad_norm: 5.0
  v_head_max_grad_norm: 0.1
  max_length: 1536
  max_prompt_length: 1152
  max_tokens: 352
  activation_checkpointing: true
  batch_size: 2
  microbatch_size: null
  gradient_accumulation_steps: 4
  eval_batch_size: 8
  eval_microbatch_size: null
  attn_implementation: flash_attention_2
  use_peft: false
  save_freqs: 4
  summary_dropout_prob: 0.1
  reg_scale: 10
  target_w_draft: 0.3
  load_lora_from: null
  peft:
    lora_r: 64
    lora_alpha: 256
    lora_dropout: 0.05
    target_modules: all-linear
  draft_name_or_path: facebook/opt-6.7b
  target_name_or_path: facebook/opt-125m
loss:
  trainer: ReinforceTrainer
  dataloader: SFTDataLoader
